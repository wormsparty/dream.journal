{% extends 'base.html' %}

{% block header %}
{% endblock %}

{% block content %}
    <div id="left-menu" class="content">
        <div class="pure-menu">
            <div style="height: 30px"></div>
            <span class="pure-menu-heading"></span>
            <ul id="subject-list" class="pure-menu-list">
                <li class="pure-menu-item centered">
                    <button class="primary-button pure-button" style="background: transparent">
                        <i class="fas fa-search" style="color: #FFF"></i>
                    </button>
                    <button class="primary-button pure-button" style="background: transparent">
                        <i class="fas fa-cogs"></i>
                    </button>
                </li>
                <li class="pure-menu-heading">
                    <div style="height: 20px"></div>
                    Sujets
                </li>
                <li id="add-subject" class="pure-menu-item centered" style="padding: 10px 0 20px 0;">
                    <button class="primary-button pure-button" data-micromodal-trigger="modal-1" style="background: transparent">
                        <i class="fas fa-plus"></i>
                    </button>
                </li>
            </ul>
        </div>
    </div>
    <div id="right-menu" class="content">
        <div class="pure-menu">
        <div style="height: 20px"></div>
        <span class="pure-menu-heading centered"></span>
            <ul class="pure-menu-list">
                <li class="pure-menu-item centered">
                    <button class="primary-button pure-button" style="min-width: 100px; margin-bottom: 10px;">Aujourd'hui</button>
                </li>
                <li class="pure-menu-item centered">
                    <a href="#" class="pure-menu-link">2014</a>
                </li>
                <li class="pure-menu-item centered">
                    <a href="#" class="pure-menu-link">2015</a>
                </li>
                <li class="pure-menu-item centered">
                    <a href="#" class="pure-menu-link">2016</a>
                </li>
                <li class="pure-menu-item centered">
                    <a href="#" class="pure-menu-link">2017</a>
                </li>
                <li class="pure-menu-item centered">
                    <a href="#" class="pure-menu-link">2018</a>
                </li>
                <li class="pure-menu-heading">
                    <div style="height: 20px"></div>
                    Templates
                </li>
                <li class="pure-menu-item">
                    <a href="#" class="pure-menu-link">
                        <span class="tag1"></span>
                        Rêve
                    </a>
                </li>
                <li class="pure-menu-item">
                    <a href="#" class="pure-menu-link">
                        <span class="tag2"></span>
                        Journée
                    </a>
                </li>
                <li class="pure-menu-item centered" style="padding: 10px 0 20px 0;">
                    <button class="primary-button pure-button" style="background: transparent">
                        <i class="fas fa-plus"></i>
                    </button>
                </li>
            </ul>
        </div>
    </div>
    <div id="content" class="content">
        <div style="height: 45px"></div>
        <form class="pure-form">
            <input class="search-bar" />
            <textarea class="text-content" wrap="hard"></textarea>
        </form>
    </div>
    <div class="modal micromodal-slide" id="modal-1" aria-hidden="true">
        <div class="modal__overlay" tabindex="-1" data-micromodal-close>
            <div class="modal__container" role="dialog" aria-modal="true" aria-labelledby="modal-1-title">
                <header class="modal__header">
                    <h2 class="modal__title" id="modal-1-title">
                        Ajout de sujet
                    </h2>
                </header>
                <main class="modal__content" id="modal-1-content">
                    <form class="pure-form">
                        <button id="ajouter_couleur" class="color-picker pure-button" style="width: 30px; height: 30px; background-color: rgb(255, 255, 255);" type="button">#FFFFFF</button>
                        <input id="ajouter_sujet" class="search-bar" style="width: 360px; left: inherit; border: 1px solid #000; box-shadow: none;"/>
                        <br/>
                    </form>
                </main>
                <footer class="modal__footer">
                    <button class="primary-button pure-button" style="margin-left: 300px" onclick="onAjouter()">Ajouter</button>
                </footer>
            </div>
        </div>
    </div>

    <script type="text/javascript">
        function onAjouter(e) {
            var sujet = $('#ajouter_sujet').val();
            var couleur = $('#ajouter_couleur').text();

            console.log('Sujet à ajouter: ' + sujet + ', couleur: ' + couleur);

           /* if (sujet !== undefined && sujet.trim() !== '') {
                $.post('/add_subject', {
                    subject: sujet,
                    color: couleur
                }, function() {
                    console.log('Posté');
                    location.reload();
                });
            }*/
        }

        $(document).ready(function() {
            MicroModal.init();

            new Huebee('.color-picker', {
                notation: 'hex',
                saturations: 1,
            });

            $.post('/get_subjects', null, function(data) {
                console.log('get_subjects: ' + data);

                let json = JSON.parse(data);
                let subject_list = $('#subject-list');
                let add_subject = $('#add-subject');

               /* for(let i = 0; i < json.length; i++)
                {
                    let newElement = document.createElement('div');

                    newElement.innerHTML = `
                       <li class="pure-menu-item">
                            <a href="#" class="pure-menu-link deletable">
                                <span class="tag" style="background: ${json[i].color}"></span>
                                ${json[i].subject}
                            </a>
                       </li>
                    `;

                    subject_list.insertBefore(newElement, add_subject[0]);
                }*/


            });

            /*let items = [
                { name: 'Editer', fn: function(target) { console.log('Cut', target); }},
            ];

            new ContextMenu('.deletable', items, {
                className: 'custom-theme',
                minimalStyling: true
            });*/
        });
    </script>
{% endblock %}